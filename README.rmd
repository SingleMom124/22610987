---
output:
  md_document:
    variant: markdown_github
---

# Question 1:

This project explores baby naming trends in the United States, examining data from 1910 to 2014. The analysis focuses on identifying patterns influenced by cultural and societal factors, such as popular media and historical events.

Utilizes panel data on baby names, actor credits, and HBO titles.

```{r message=FALSE, warning=FALSE, include=FALSE}

rm(list = ls())
gc() 

library(tidyverse)
library(readr)

list.files('Question1/code/', full.names = T, recursive = T) %>% .[grepl('.R', .)] %>% as.list() %>% walk(~source(.))

baby_names <- read_rds("Question1/data/Baby_Names_By_US_State.rds")
charts <- read_rds("Question1/data/charts.rds")
hbo_titles <- read_rds("Question1/data/HBO_titles.rds")
hbo_credits <- read_rds("Question1/data/HBO_credits.rds")

```

First I plotted the Spearman correlation between the 25 current most popular baby names, current referring to the your in question, and the 25 most popular names 3 years from then. I do this for boys and girls names separately and then together:

```{r}

# Getting the Spearman correlations in the form of plot data using my spearman_plot function...

plot_data_M <- spearman_corr(baby_names, gender = "M")
plot_data_F <- spearman_corr(baby_names, gender = "F")

# ... and plotting said data using my time series correlation plotter function.

plots <- ts_corr_plotter(plot_data_M, plot_data_F)
plots

```

What we see here is a decline in the persistence of naming trends for boys names since the 1990s, while girls' names have demonstrated greater resilience over time. However, overall, we do see a decline in the persistence of naming trends since the 1990s, confirming the agencies suspicion.

Next I look at what other cultural influences may be impacting on these trends, such as actor names. I do this by plotting the the 5 most popular names throughout the entire data set and their trends over time, finding that have all seen a fairly large decline in their prevalence since their peaks. The most popular boys names seems to have moved together while the most popular girls names seemed to see more independent bouts of popularity. 

```{r}

# Plotting the top 5 persistently popular names per gender throughout the years

top_male_names <- name_plotter(baby_names, gender = "M")
top_male_names

top_female_names <- name_plotter(baby_names, gender = "F")
top_female_names

```

Using these names in conjunction with the hbo data and the baby names data, I created a dummy for whether an actor with a popular name appeared in a title and what that names count would be for that year. This was done for all actor names, not just the popular ones. I then ran regressions on a names count.

Here I include the Breusch-Pagan and Hausman tests as I could not get them to knit In the pdf.

```{r echo=FALSE, message=FALSE, warning=FALSE}

# Using the 'plm' package to run regressions on the panel data, which I employ using my names_reg function

actor_names_M <- names_reg_test(baby_names, hbo_credits, hbo_titles, gender = "M")
actor_names_M

actor_names_F <- names_reg_test(baby_names, hbo_credits, hbo_titles, gender = "F")
actor_names_F

```

For both male and female names the Breusch-Pagan tests suggest that pooled OLS is insufficient. Where they differ is the model type. 

For the male names the Hausman test has a small p-value, indicating that the fixed effects (FE) model better represents the effect of an actor with a popular name being in a title on name counts for that year. 

For the female names the Hausman test has a larger p-value, indicating that the random effects (RE) model better represents the effect of an actor with a popular name being in a title on name counts for that year. 

However both suggest that media such as movies and television, significantly impact naming conventions. Analysis reveals correlations between popular actor names and increased occurrences of those names in baby naming trends.

# Question 2:

This project explores the musical evolution of Coldplay and Metallica through detailed analysis of their discographies using data from Spotify and Billboard. The analysis focuses on their studio recordings to maintain consistency and relevance in comparisons.

Data Sources: Utilizes Spotify data for musical attributes and Billboard Top 100 charts data to contextualize trends.

```{r include=FALSE}
rm(list = ls()) 
gc() 

library(readr)
library(tidyverse)

list.files('Question2/code/', full.names = T, recursive = T) %>% .[grepl('.R', .)] %>% as.list() %>% walk(~source(.))

coldplay <- read_csv("Question2/data/Coldplay.csv")
metallica <- read_csv("Question2/data/metallica.csv")
spotify <- read_rds("Question2/data/Broader_Spotify_Info.rds")
billboard_100 <- read_rds("Question2/data/charts.rds")

```

## Data Visualization:

```{r}
# Using functions to filter out all non-studio songs...

coldplay_studio <- studio_filter(coldplay)
metallica_studio <- studio_filter(metallica)

c_plot <- box_plotter(coldplay_studio, "popularity", title = "Popularity by album (Coldplay)")
m_plot <- box_plotter(metallica_studio, "popularity", title = "Popularity by album (Metallica)")
c_plot
m_plot
```

Box and whisker plots show that Coldplay has more consistent popularity levels across their albums, while Metallica's popularity varies significantly, with notable peaks for certain albums.

```{r}
# First wrangling the Spotify and billboard data a little bit and joining them...

billboard_100 <- billboard_100 %>% 
    rename(name = song)

mainstream_music <- inner_join(spotify, billboard_100, by = c("name", "artist"))
mainstream_music <- mainstream_music %>% 
    rename(release_date = date)

# .. then feeding it to my attributes plotting function

attributes <- band_attributes(metallica_studio, coldplay_studio, mainstream_music, band_name1 = "Metallica", band_name2 = "Coldplay", band_name3 = "Billboard100")
print(attributes)
```

Metallica shows fluctuating but overall high energy levels throughout their career. Coldplay started of their careers making more melow music but shows a rising trend in energy over the years, indicating a shift towards more energetic music in their later works.

Valence for both bands shows interesting trends. Metallica generally has a lower valence compared to Coldplay, likely due to the subject matter of some of their songs. Coldplay's valence has varied but shows a slight upward trend, indicating more positive or emotionally uplifting music in recent years.

Metallica maintains a lower danceability score throughout their career but given that they primarily produce thrash metal this is consistent with their genre and style. Coldplay's danceability shows an increasing trend, aindicating a move towards more pop and rhythm-oriented music in recent albums.

Both bands exhibit changes in song duration over the years. Metallica’s song durations have seen more fluctuation but they generally tend to be much longer than that of Coldplay. However, Coldplay's songs have seen an increase in duration over time, possibly refelcting more complex song structures or varied musical explorations.

Compared to the Billboard 100, Metallica's music stands out with higher energy and lower valence, emphasizing their thrash metal identity while Coldplay’s musical progression aligns more closely with mainstream trends, showing increasing energy and danceability, possibly explaining their more consistent levels popularity.

```{r}
m_heatmap <- heat_mapper(metallica_studio, title = "Heatmap for Metallica Songs")
m_heatmap
c_heatmap <- heat_mapper(coldplay_studio, title = "Heatmap for Coldplay Songs")
c_heatmap
```

Heat map for Metallica shows that loudness and energy are highly positively correlated, as are acousticness and liveness. On the other hand, danceability and acousticness, danceability and loudness, and instrumentalness and valence have notable negative correlations.This suggests that Metallica's loud and energetic music tends to be less danceable and less acoustic.

Heat map for Coldplay shows that energy and loudness, and acousticness and valence all see positive correlations while danceability and acousticness, and liveness and acousticness see negative correlations. This indicates that Coldplay's more energetic and loud songs tend to be less acoustic, and there is a distinct separation between acoustic and danceable tracks.

# Question 3:

Project focuses on international aid efforts amidst the Russia-Ukraine conflict, specifically analyzing which countries are actively contributing to Ukraine's defense and humanitarian needs. Highlighting both leading contributors and areas of criticism, the segment aims to provide viewers with insights into global responses and their implications for the ongoing conflict.

```{r message=FALSE, warning=FALSE, include=FALSE}

rm(list = ls()) 
gc()

library(tidyverse)
library(readr)

list.files('Question3/code/', full.names = T, recursive = T) %>% .[grepl('.R', .)] %>% as.list() %>% walk(~source(.))

alloc <- read_csv("Question3/data/Financial Allocations.csv")
commit <- read_csv("Question3/data/Financial Commitments.csv")

```

## Data Visualisation:

Looking at the scale effect of each countries commitments and allocations as a proportion of their total GDP. It is important to note here that Estonia's allocation was more than 75% of its GDP and Malta's more than 30%. This seems unlikely and is verifiably false. For example, a quick Google shows that Estonia's allocations as of 2024 amount to 1.4% of its GDP. This is likely due to measurement error and so these two countries have been removed from the data.

```{r echo=FALSE, message=FALSE, warning=FALSE}

# Just a small bit of wrangling...

# ... by joining the data sets by "country" and "EU member" columns so that I only have to work with one data set...

data <- inner_join(alloc, commit, by = c("Country", "EU member"))

# ... and then filtering out countries who are not EU Members

data <- data %>% 
    filter(`EU member` == 1) %>%
    mutate(Allocations_GDP_Percent = (`Total bilateral allocations($ billion)` / `GDP in 2021($ billion)`) * 100) %>% 
    mutate(Commitments_GDP_Percent = (`Total bilateral commitments($ billion)` / `GDP in 2021($ billion)`) * 100)

plot <- ggplot(data, aes(x = Country, 
                         y = Allocations_GDP_Percent)) +
        geom_bar(stat = "identity", 
                 fill = "navy") +
        labs(title = "Total Allocations as a Proportion of GDP",
             x = "Country",
             y = "Percentage of GDP") +
        theme_minimal() +
        theme(axis.text.x = element_text(size = 7, angle = 45, hjust = 1)) +
        theme(panel.border = element_rect(color = "black", fill = NA, size = 1))
plot

```

The plot reveals massive outliers such as Estonia with an allocation of more than 75% of its GDP and Malta's more than 30%. This seems unlikely. Probably measurement error so they need to be removed.

Plotting this filtered data as a double bar graph that compares a EU members allocation to what it committed to allocate.

```{r echo=FALSE, message=FALSE, warning=FALSE}

# Filtering out Estonia and Malta...

data <- data %>%
    filter(!Country %in% c("Estonia", "Malta"))

# Now plotting it using my "double_bar_plotter" function...

compare_plot <- double_bar_plotter(data)
compare_plot

```

Also using the filtered data to plot how many EU members allocated as much they committed versus how many fell short...

```{r echo=FALSE, message=FALSE, warning=FALSE}

# Plot this using my "allocation_proportions" function

proportions <- allocation_proportions(data)
proportions

```

... as well as which countries have the highest relative allocations.

```{r echo=FALSE, message=FALSE, warning=FALSE}

# Plot this using my "allocation_head" function...

allocation_head <- allocation_head(data)
allocation_head

```

Some main points to gather from this are that even though most EU members allocated at least as much aid to Ukraine as what they committed, 48% failed to meet their commitment. Additionally, it seems as though countries closer to the conflict have the highest allocations, these including mostly slavic nations and former USSR occupants.

# Question 4:

```{r message=FALSE, warning=FALSE, include=FALSE}

rm(list = ls()) 
gc()

library(tidyverse)
library(readr)

list.files('Question4/code/', full.names = T, recursive = T) %>% .[grepl('.R', .)] %>% as.list() %>% walk(~source(.))

Winter <- read_rds("Question4/data/winter.rds")
Summer <- read_rds("Question4/data/summer.rds")
colnames(Summer)[6] <- "Code"
colnames(Winter)[6] <- "Code"
GDP <- read_rds("Question4/data/GDP.rds")

```

Looking at how India cumulatively fared in past Olympic events and comparing this to Brazil, Pakistan, and South Africa during years in which they all competed. These countries were chosen as Pakistan is of similar economic standing and Brazil and South Africa are both emerging market economies, one from South America and one from Africa, providing a fair and diverse comparison.India falls short of all of them with regard to bronze, silver, and gold medals, except Pakistan.

```{r}
# Joining the summer Olympic and GDP data by country code

summer_gdp <- left_join(Summer, GDP, by = "Code")

# Using my "medal counter function"team_adjuster" function

summer_medals <- team_adjuster(summer_gdp)

# Now plotting this data using my "country_comparison" function, comparing India to similar and emerging economies...

india_compare <- country_comparison_bar(summer_medals, GDP, "India")
india_compare
```

The plot below shows the three most consistently dominant countries, in both the summer and the winter Olympics are France, the United Kingdom, and the United States, all of which see medal counts higher than average across the board

```{r}
# A small bit of wrangling, bindin the summer and winter Olympics sets together and join GDP to this new data set by the "Code" column

olympics <- rbind(Summer, Winter)
olympics_gdp <- left_join(olympics, GDP, by = "Code")

# Using the my "team_adjuster" function to account for duplicate medals...

team_adjusted <- team_adjuster(olympics_gdp)

# ... and inseting the output in to my "high_performance" function

dominant_countries <- high_performance(team_adjusted)
dominant_countries
```

Countries who manage to punch above their weight include Finland, France, Hungary, and Italy. We define this as a countries ability to win more medals than the average fairly consistently as well as by the number of athletes they have competing in a given year.

```{r}

# Plotted using my "above_weight" function

no_odds <- above_weight(summer_gdp, summer_medals)
no_odds
```
Now plotting which countries have the most medals per athlete. The United States takes the cake by far here.

```{r}

# Plotted using my "all_time_best" function

best_athletes <- all_time_best(olympics_gdp)
best_athletes
```

# Question 5:

I could not get this question to work.

```{r message=FALSE, warning=FALSE, include=FALSE}

rm(list = ls()) 
gc()

library(dbbasic)
library(DBI)
```

```{r}
usethis::edit_r_environ()
```

```{r}
library(dbbasic)
conn <- db_connect(db = "datascience")
```




